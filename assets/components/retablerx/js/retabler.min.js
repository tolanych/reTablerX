/**
 * ReTabler
 * @author tolanych <https://github.com/tolanych>
 * @example
 *	ReTabler.add('#sometable');
 *	ReTabler.add('section.content table');
 *	ReTabler.add('body table');
*/

!function(e){e.closest=e.closest||function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null}}(Element.prototype);var ReTabler=function(){var c=function(){};return c.add=function(e,t,r){$prefix=t||"retabler-",$pad=r||"35%",i=1,[].forEach.call(document.querySelectorAll(e),function(e){e.getAttribute("retabler")!=$pad&&(e.classList.add($prefix+i),c.generateCss(e,$prefix+i,$pad),e.setAttribute("retabler",$pad),i++)})},c.generateCss=function(e,t,r){var l=0,o="td",a="";if(t="."+t,is_head=e.querySelectorAll("thead"),is_head.length?(o="th",wrapper_head=is_head[0]):(firsttr=e.querySelectorAll("tr")[0],firsttr.querySelectorAll("th")[0]&&(o="th"),wrapper_head=document.createElement("thead"),targetNode=firsttr.closest("table"),targetNode.insertBefore(wrapper_head,targetNode.firstChild),wrapper_head.appendChild(firsttr)),[].forEach.call(e.querySelectorAll("thead tr:nth-child(1) "+o),function(e){if(e.getAttribute("colspan"))return console.log(t+": dont reorganize table with colspan"),!1;l++}),l<4)return console.log(t+": dont reorganize table with column less 4"),!1;a="@media  only screen and (max-width: 768px), (min-device-width: 768px) and (max-device-width: 1024px) {";var n=[" { display:block; }","thead { display:none; }","tbody { display:block; }","th { display:block; }","tr { display:block; border: 1px solid #ccc;}","td { display:block; border: none; border-bottom: 1px solid #eee; position: relative; padding-left: "+r+"!important; }","td:before { position: absolute;left: 6px; width: "+r+"; padding-right: 10px!important; }"];[].forEach.call(n,function(e){a+=t+" "+e}),i=1,[].forEach.call(wrapper_head.querySelectorAll(o),function(e){a+=t+" td:nth-of-type("+i+++'):before { content:"'+e.textContent.trim()+'"; }'}),a+="}";var d=document.createElement("style");d.type="text/css",d.id="st-"+t,d.innerHTML=a,document.querySelectorAll("head")[0].appendChild(d),c.calculateHeight(e),window.addEventListener("resize",function(){c.calculateHeight(e)},!1)},c.calculateHeight=function(e){[].forEach.call(e.querySelectorAll("tbody td"),function(e){_hht=window.getComputedStyle(e,null).getPropertyValue("height"),_hhc=window.getComputedStyle(e,":before").getPropertyValue("height"),_hhc=Number(_hhc.slice(0,-2)),_hht=Number(_hht.slice(0,-2)),_hhc>_hht&&(e.style["min-height"]=_hhc+"px")})},c}();